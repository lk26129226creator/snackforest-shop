/*
==============================================
SnackForest - 全局樣式表 (顏色已還原)
==============================================
*/

/* --- 1. Google Fonts & 全局變數 --- */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Poppins:wght@300;400;500;600&display=swap');

:root {
    --primary-color: #4a7c59;      /* 原始主題綠 */
    --secondary-color: #6a994e;    /* 原始次要綠 */
    --accent-color: #a3b18a;       /* 原始點綴綠 */
    --text-color: #333;            /* 原始文字顏色 */
    --card-bg: #ffffff;            /* 卡片背景 */
    --border-color: #dee2e6;       /* 邊框顏色 (保留) */
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.12);
    --border-radius: 0.75rem;      /* 圓角 (新) */
    --font-sans-serif: 'Poppins', 'Noto Sans TC', sans-serif;
}

/* --- 2. 基礎與排版 --- */
body {
    background-color: var(--background-color);
    font-family: var(--font-sans-serif);
    color: var(--text-color);
    line-height: 1.7;
    padding-top: 96px; /* 為固定導覽列預留空間 (加高 navbar) */
}

h1, h2, h3, h4, h5, h6 {
    font-weight: 600;
    color: var(--primary-color);
}

/* --- 3. 導覽列 --- */
.navbar {
    background-color: var(--primary-color);
    box-shadow: var(--shadow);
}

/* Make navbar fixed at top and slightly taller */
.navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 72px;
    display: flex;
    align-items: center;
    z-index: 1050;
}
.navbar .container-fluid { align-items: center; }
.navbar-brand, .nav-link {
    color: #fff !important;
    font-weight: 500;
    transition: color 0.2s ease;
}

.nav-link:hover, .nav-link.active {
    color: #e9ecef !important;
}

/* --- 4. 按鈕與表單 --- */
.btn {
    border-radius: var(--border-radius);
    font-weight: 500;
    padding: 0.6rem 1.2rem;
    transition: all 0.3s ease;
}

.btn-primary {
    background-color: var(--primary-color);
    border: none;
}

.btn-primary:hover {
    background-color: var(--secondary-color);
    transform: translateY(-2px);
    box-shadow: var(--shadow-hover);
}

.form-control, .form-select {
    border-radius: var(--border-radius);
    padding: 0.6rem 1rem;
    border: 1px solid var(--border-color);
}

.form-control:focus, .form-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(74, 124, 89, 0.2);
}

/* --- 5. 卡片 --- */
.card {
    border: none;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    background-color: var(--card-bg);
    transition: all 0.3s ease;
}

    .summary-card.card { box-shadow: var(--shadow); border-radius: var(--border-radius); transition: none; }

/* Make the cart summary sticky on larger screens and remove any jump animations */
@media (min-width: 992px) {
    .summary-card.card {
        position: sticky;
        top: 96px; /* sit under navbar */
        align-self: start;
    }
}

/* Ensure summary card does not move on hover (override global .card:hover) */
.summary-card.card:hover { transform: none !important; }

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
}

/*
==============================================
客戶端頁面樣式 (Client-side)
==============================================
*/

/* --- 商品網格 --- */
.product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.75rem;
}

.product-card .card-body {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.product-card .product-image-wrapper {
    height: 200px;
    overflow: hidden;
}

.product-card .product-card-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.product-card.hover-pop-scale .product-card-img {
    transform: scale(1.05);
}

/* Make product card indicate interactivity and improve hover UX */
.product-card {
    cursor: pointer;
}

/* Hover Popover: fixed, two-column layout with left column stacked (main image + thumbs) */
#product-hover-popover {
    position: fixed;
    inset: 3% 4%; /* slightly reduce inset so popover can use more vertical space */
    z-index: 2000;
    display: block;
    opacity: 0;
    transform: translateY(8px) scale(0.98);
    transition: opacity 200ms ease, transform 200ms ease;
    pointer-events: none;
    visibility: hidden;
    background-color: rgba(255,255,255,0.98);
    border-radius: 0.75rem;
    box-shadow: 0 22px 48px rgba(0,0,0,0.36);
}

#product-hover-popover.show { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; visibility: visible; }

#product-hover-popover .popover-inner { display: grid; grid-template-columns: auto 1fr; gap: 0.75rem; padding: 0.9rem 0.9rem 0.6rem 0.9rem; align-items: start; }

#product-hover-popover .popover-inner .left { padding: 0.25rem 0.5rem 0.25rem 0.5rem; display:flex; flex-direction:column; min-width:220px; max-width:520px; }
#product-hover-popover .popover-inner .left #popover-thumbs { margin-top: 0.8rem; display:flex; align-items:center; overflow-x:auto; gap:0.6rem; padding-bottom:12px; }
#product-hover-popover .popover-inner .popover-thumb { border-radius: 0.5rem; box-shadow: var(--shadow); flex:0 0 auto; }
/* larger thumbs inside popover */
#product-hover-popover .popover-inner .left #popover-thumbs img { width:56px; height:56px; object-fit:cover; border-radius:0.5rem; box-shadow: var(--shadow); }
/* thumb-nav buttons inline with thumbs */
.thumbs-row { display:flex; align-items:center; }
.thumbs-row .btn { min-width:48px; height:48px; display:inline-flex; align-items:center; justify-content:center; border-radius:50%; }
/* smooth scrolling for thumbs */
#product-hover-popover .popover-inner .left #popover-thumbs { scroll-behavior: smooth; }
/* make product introduction larger in popover */
#product-hover-popover #popover-introduction { font-size: 1rem; line-height:1.6; }

/* metadata styling to increase visibility */
#popover-metadata small { display:block; background: #f7fff6; padding:8px 10px; border-radius:8px; margin-bottom:8px; color: #2f5f3a; }

/* Active thumbnail highlight inside popover */
#popover-thumbs { position: relative; z-index: 3000; }
#popover-thumbs .popover-thumb {
    position: relative;
    z-index: 3010;
    transition: transform 160ms ease, box-shadow 160ms ease;
    display: inline-block; /* ensure padding/box-shadow not clipped */
    padding: 4px; /* space for the visual ring */
    background: transparent;
    overflow: visible;
}
#popover-thumbs .active-thumb {
    /* use box-shadow ring instead of outline to avoid clipping by parent border-radius */
    transform: scale(1.03);
    z-index: 3020;
    box-shadow: 0 0 0 4px var(--secondary-color), 0 8px 20px rgba(46,125,50,0.12);
    border-radius: 0.55rem;
}
/* limit thumbnail container width so main image and thumbs layout nicely */
#product-hover-popover .popover-inner .left { max-width: 520px; }

/* make product title larger in popover */
#product-hover-popover .card-title#popover-product-name { font-size: 1.35rem; font-weight:700; }

/* Ensure main image leaves room for thumbnails and right column */
/* Use a more flexible rule for the popover's main image (left column) so tall images fit and are centered */
#product-hover-popover .popover-inner .left img {
    display:block;
    margin:0 auto 10px auto; /* add bottom gap so thumbs are not overlapped */
    max-height: calc(72vh - 120px);
    max-width: 480px; /* larger main display */
    width: auto;
    height: auto;
    object-fit: contain;
    border-radius:0.5rem;
    background: linear-gradient(180deg,#fff,#fbfbfb);
    padding:6px;
    position: relative;
    z-index: 2000; /* keep main image below thumbnails */
}

/* force qty group into single line and prevent wrapping */
#product-hover-popover .popover-inner .right .input-group { display:inline-flex; flex-wrap:nowrap; align-items:center; gap:8px; }
#product-hover-popover .popover-inner .right .input-group input { text-align:center; }
#product-hover-popover input.form-control { color: #222 !important; font-size: 1rem !important; background: #fff !important; }
/* Stronger override: ensure number is visible across browsers (webkit text-fill, line-height, padding) */
#product-hover-popover input.form-control#popover-qty,
#product-hover-popover input.form-control[type=number],
#product-hover-popover input.form-control[type=text] {
    color: #222 !important;
    -webkit-text-fill-color: #222 !important;
    font-size: 1rem !important;
    line-height: 1.2 !important;
    padding: 0.375rem 0.5rem !important;
    background: #fff !important;
    height: auto !important;
    text-indent: 0 !important;
    text-align: center !important;
}

/* Make the +/- buttons in popover smaller so they don't overlap the center value */
#product-hover-popover .input-group .btn {
    width: 36px !important;
    height: 36px !important;
    padding: 0 !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 8px !important;
}

/* Enlarge center number for readability */
#product-hover-popover #popover-qty {
    font-size: 1.1rem !important;
    font-weight: 600 !important;
}

/* popover overall limits */
#product-hover-popover { max-height: calc(100vh - 24px); overflow: visible; }

/* overlay when popover is open */
#popover-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.32); z-index:1990; opacity:0; visibility:hidden; transition:opacity 180ms ease; }
#popover-overlay.show { opacity:1; visibility:visible; }

/* Ensure the global live toast notification is always on top of popovers/overlays */
#liveToast { z-index: 2147483647 !important; position: fixed !important; }
#liveToast .toast { z-index: 2147483647 !important; }

/* Enhanced toast UI */
#liveToast { right: 1rem; top: 1rem; left: auto; bottom: auto; }
#liveToast .toast {
    min-width: 280px;
    max-width: 420px;
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid rgba(74,124,89,0.12);
    background: linear-gradient(180deg, #ffffff, #fbfff9);
    box-shadow: 0 12px 28px rgba(18, 66, 30, 0.14);
}
#liveToast .toast-header {
    background: linear-gradient(90deg, rgba(106,153,78,0.12), rgba(163,177,138,0.06));
    border-bottom: 1px solid rgba(0,0,0,0.03);
    padding: 0.5rem 0.75rem;
    align-items: center;
}
#liveToast .toast-header .me-auto {
    font-weight: 700;
    color: #2f5f3a;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
/* add a small check icon before the title */
#liveToast .toast-header .me-auto::before { content: "\2713"; display:inline-block; width:20px; height:20px; line-height:20px; text-align:center; border-radius:50%; background:#2f5f3a; color:#fff; font-size:12px; }
#liveToast .toast-body { padding: 0.6rem 0.75rem; color: #234a2b; font-weight: 500; }

/* success variant for slightly stronger accent */
.toast-success { border-color: rgba(46,125,50,0.2) !important; }
.toast-success .toast-header { background: linear-gradient(90deg, rgba(74,124,89,0.18), rgba(74,124,89,0.06)); }

/* Toast content layout */
.toast-item .toast-name { font-weight: 700; color: #163b25; max-width: 180px; }
.toast-item .toast-sub { color: rgba(30,50,30,0.6); }
.toast-qty { font-weight: 700; padding: 0.45rem 0.6rem; border-radius: 0.6rem; }
.toast-cta { font-size: 0.85rem; padding: 0.35rem 0.6rem; border-radius: 8px; }
.toast-cta:hover { text-decoration: none; }

/* Close button inside popover */
#product-hover-popover > #popover-close-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 2100;
}

/* Remove number input spinners (WebKit & Firefox) so only +/- buttons control quantity */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}
input[type=number] {
    -moz-appearance: textfield;
    appearance: textfield;
}

/* On small screens collapse to single column */
@media (max-width: 768px) {
    #product-hover-popover {
        inset: 8px;
        border-radius: 0.5rem;
    }
    #product-hover-popover .popover-inner { grid-template-columns: 1fr; }
    body { padding-top: 72px; }
}

/* --- Product card image adjustments: taller and show full image --- */
.product-card {
    min-height: 460px; /* make cards taller so image can fully show */
}
.product-card .product-image-wrapper {
    height: 320px; /* taller image area */
    display: flex;
    align-items: center;
    justify-content: center;
    background: #fafafa;
    padding: 8px;
}
.product-card .product-card-img {
    width: 100%;
    height: 100%;
    object-fit: contain; /* show full image */
    transition: transform 0.25s ease;
}

@media (max-width: 768px) {
    .product-card { min-height: 420px; }
    .product-card .product-image-wrapper { height: 240px; }
}

.product-card .card-title {
    font-size: 1.1rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    overflow: hidden;
    text-overflow: ellipsis;
    min-height: 2.4em; 
}

.product-card .price {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--secondary-color);
    margin-top: auto; 
}

.product-card .card-footer {
    background-color: transparent;
    border-top: none;
}

/* Thumbnail scroller (product detail) */
.thumbs-wrapper { display:flex; align-items:center; width:100%; }
.thumbs-container { overflow-x:auto; display:flex; gap:0.5rem; -webkit-overflow-scrolling: touch; flex:1 1 auto; }
.thumbs-container img { flex:0 0 auto; width:80px; height:80px; object-fit:cover; border-radius:0.5rem; }
.thumb-nav { width:44px; height:44px; display:inline-flex; align-items:center; justify-content:center; border-radius:50%; background:#fff; border:1px solid rgba(0,0,0,0.06); box-shadow: 0 6px 18px rgba(0,0,0,0.12); padding:0; }
.thumb-nav:hover { transform: translateY(-2px); }
.thumb-nav:active { transform: translateY(0); }
.thumb-nav svg { width:18px; height:18px; }
.thumb-nav[style*="display: none"] { visibility: hidden; }

/*
==============================================
管理端頁面樣式 (Admin-side)
==============================================
*/

.main-content {
    padding: 2rem 4rem;
}

.admin-section {
    display: none;
    animation: fadeIn 0.4s ease-in-out;
}

.admin-section.active {
    display: block;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
}

.admin-section h1, .admin-section h2 {
    margin-bottom: 1.5rem;
}

.admin-form-section {
    background-color: var(--card-bg);
    padding: 2rem;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    margin-bottom: 2rem;
}

.table-responsive {
    background-color: var(--card-bg);
    padding: 1rem;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
}

.table {
    border-color: var(--border-color);
}

.table thead th {
    background-color: #f8f9fa;
    color: var(--text-color);
    font-weight: 600;
    border-bottom-width: 2px;
}

.table tbody tr:hover {
    background-color: #f1f3f5;
}

.table-actions .btn {
    margin-right: 0.5rem;
    padding: 0.3rem 0.6rem;
    font-size: 0.875rem;
}

.table-product-img {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 0.5rem;
}

.image-preview-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1rem;
}

.image-preview-item {
    position: relative;
    width: 100px;
    height: 100px;
}

.image-preview-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
}

/* Product detail: metadata and introduction styling */
.product-intro {
    color: var(--text-color);
    background: transparent;
    line-height: 1.8;
}

/* Product meta card (separate container) */
#product-meta-card {
    border-radius: calc(var(--border-radius) - 0.15rem);
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,252,251,0.98));
    padding: 0.6rem 0.9rem;
    box-shadow: 0 14px 36px rgba(11,22,15,0.07);
    border: 1px solid rgba(74,124,89,0.08);
    margin-bottom: 1rem;
    position: relative;
}

/* removed left accent bar for cleaner look */
/* previously used ::before accent; intentionally left out for a cleaner UI */

/* metadata area inside the card */
#product-metadata {
    border-radius: 0.5rem;
    background: transparent; /* keep card background, avoid double blocks */
    padding: 0.6rem 0.9rem; /* comfortable padding */
    color: #495057;
    display: flex;
    flex-direction: column; /* stack items vertically */
    gap: 0.6rem;
    align-items: flex-start;
    font-size: 1rem;
}

/* pill-like metadata items for better readability */
#product-metadata .meta-item {
    background: rgba(255,255,255,0.92);
    padding: 0.5rem 0.9rem;
    border-radius: 0.6rem;
    color: #2f4530;
    box-shadow: 0 6px 18px rgba(13,24,10,0.04);
    font-size: 1rem;
    width: 100%;
    border-left: 4px solid rgba(74,124,89,0.06); /* subtle left accent on each pill */
}

@media (max-width: 768px) {
    #product-meta-card { padding: 0.4rem; }
    #product-metadata { padding-left: 0.9rem; gap: 0.6rem; font-size: 0.96rem; }
    #product-meta-card::before { left: 10px; top: 10px; bottom: 10px; }
}

/* Product title & intro emphasis (product detail) */
#product-detail-container h1, #product-detail-container .h3 {
    font-size: 1.6rem; /* larger main title */
    line-height: 1.05;
    margin-bottom: 0.35rem;
}

@media (min-width: 992px) {
    #product-detail-container h1, #product-detail-container .h3 {
        font-size: 2rem;
    }
    .product-intro { font-size: 1.08rem; }
    #product-metadata { font-size: 1.02rem; }
    #product-meta-card { padding: 0.7rem 1rem; }
}

@media (min-width: 1200px) {
    #product-detail-container h1, #product-detail-container .h3 { font-size: 2.2rem; }
    .product-intro { font-size: 1.12rem; }
}

/* make introduction area a bit wider and comfortable */
#product-introduction-wrapper { max-width: 100%; }

/* emphasize product introduction on larger screens */
@media (min-width: 992px) {
    .product-intro {
        font-size: 1.05rem; /* slightly larger */
        max-width: 1100px; /* allow more horizontal space */
        font-weight: 400;
    }
    /* ensure the intro can extend beyond left column visually */
    #product-introduction-wrapper { margin-left: 0; }
}

/* tweak metadata box for clarity */
#product-metadata { font-size:0.95rem; color:#495057; }

@media (min-width:1200px) {
    .product-intro { font-size:1.12rem; max-width:1300px; }
}

/*
==============================================
響應式設計 (Media Queries)
==============================================
*/

@media (max-width: 768px) {
    body {
        padding-top: 70px;
    }
    .main-content {
        padding: 1.5rem;
    }
    .product-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
    }
    h1 { font-size: 1.75rem; }
    h2 { font-size: 1.5rem; }
}

@media (max-width: 576px) {
    .product-grid {
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }
    .product-card .card-title {
        font-size: 1rem;
    }
    .product-card .price {
        font-size: 1.1rem;
    }
}